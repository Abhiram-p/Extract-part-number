<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extract Alphanumeric Codes</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Extract 5-Digit Alphanumeric Codes</h1>
        <textarea id="inputText" rows="10" cols="50" placeholder="Enter your text here..."></textarea>
        <br>
        <button onclick="extractCodes()">Extract Codes</button>
        <div class="result-box" id="result"></div>
    </div>

    <script>
        function extractCodes() {
            const inputTextElement = document.getElementById('inputText');
            let text = inputTextElement.value;

            // Auto-format the input string
            const formattedText = text.split(';')
                                      .map(s => s.trim())
                                      .filter(Boolean)
                                      .join(';\n');
            inputTextElement.value = formattedText;
            text = formattedText;

            const resultBox = document.getElementById('result');
            resultBox.innerHTML = ''; // Clear previous results

            const parts = text.split(';').map(s => s.trim());
            const regex = /\b[A-Z0-9]{5}\b/g;
            const blacklist = ["PARTS", "COVER", "BEZEL", "BOARD", "CHASS", "FRAME", "PANEL", "CABLE", "MOUSE", "CORDS, "PLATE""];

            let allMatches = [];
            parts.forEach(part => {
                if (!part) return; // Skip empty parts
                let matches = part.match(regex) || [];
                matches = matches.filter(code => !blacklist.includes(code));

                if (matches.length > 0) {
                    const highlight = part.toUpperCase().includes('IW');
                    matches.forEach(match => {
                        allMatches.push({code: match, highlight: highlight});
                    });
                }
            });


            if (allMatches.length > 0) {
                for (let i = 0; i < allMatches.length; i += 5) {
                    const lineMatches = allMatches.slice(i, i + 5);
                    const lineDiv = document.createElement('div');
                    lineDiv.className = 'line';

                    const lineText = document.createElement('span');

                    // Create the inner HTML with spans for highlighting
                    lineText.innerHTML = lineMatches.map(match => {
                        if (match.highlight) {
                            return `<span class="highlight-green">${match.code}</span>`;
                        }
                        return match.code;
                    }).join(',');

                    lineDiv.appendChild(lineText);

                    const copyButton = document.createElement('button');
                    copyButton.textContent = 'Copy';
                    copyButton.className = 'small-button';
                    const lineForCopy = lineMatches.map(m => m.code).join(',');
                    copyButton.onclick = function() {
                        navigator.clipboard.writeText(lineForCopy);
                        alert('Text copied: ' + lineForCopy);
                    };
                    lineDiv.appendChild(copyButton);

                    resultBox.appendChild(lineDiv);
                }
            } else {
                resultBox.innerHTML = 'No 5-digit alphanumeric codes found.';
            }
        }
    </script>
</body>
</html>
